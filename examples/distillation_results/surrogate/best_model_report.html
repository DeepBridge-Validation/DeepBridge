<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Best Distilled Model - Detailed Report</title>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap/5.3.0/css/bootstrap.min.css" rel="stylesheet">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/bootstrap/5.3.0/js/bootstrap.bundle.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/d3/7.8.5/d3.min.js"></script>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            line-height: 1.6;
            color: #333;
            padding-top: 2rem;
            padding-bottom: 4rem;
            background-color: #f8f9fa;
        }
        .header {
            background: linear-gradient(135deg, #2b5876 0%, #4e4376 100%);
            color: white;
            padding: 2rem 0;
            border-radius: 0.5rem;
            margin-bottom: 2rem;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        }
        .chart-container {
            background-color: white;
            border-radius: 0.5rem;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.05);
            padding: 1.5rem;
            margin-bottom: 2rem;
        }
        .section-title {
            border-bottom: 2px solid #4e4376;
            padding-bottom: 0.5rem;
            margin-bottom: 1.5rem;
            color: #2b5876;
        }
        .metric-card {
            border-radius: 0.5rem;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.05);
            height: 100%;
            transition: transform 0.3s;
        }
        .metric-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
        }
        .card-header {
            font-weight: 600;
            border-radius: 0.5rem 0.5rem 0 0 !important;
        }
        .metrics-table {
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.05);
            border-radius: 0.5rem;
            overflow: hidden;
        }
        .metrics-table th {
            background-color: #e9ecef;
        }
        .footer {
            margin-top: 4rem;
            padding: 1rem 0;
            border-top: 1px solid #dee2e6;
            text-align: center;
        }
        .model-params {
            font-size: 1.1rem;
            padding: 1rem;
            background-color: rgba(46, 88, 118, 0.1);
            border-radius: 0.5rem;
            margin-bottom: 1.5rem;
        }
        .model-params span {
            font-weight: 600;
        }
        .feature-importance-bar {
            background-color: #4e4376;
        }
        .positive-diff {
            color: #28a745;
        }
        .negative-diff {
            color: #dc3545;
        }
        .neutral-diff {
            color: #6c757d;
        }
        .parameter-name {
            font-weight: 600;
            color: #2b5876;
        }
        .parameter-value {
            font-family: monospace;
            background-color: #f8f9fa;
            padding: 0.2rem 0.4rem;
            border-radius: 0.3rem;
        }
        .teacher-label, .student-label {
            font-weight: 500;
        }
        .teacher-label {
            color: #2b5876;
        }
        .student-label {
            color: #4e4376;
        }
        .chart-legend {
            margin-top: 1rem;
            font-size: 0.9rem;
        }
        .legend-item {
            margin-right: 1.5rem;
            display: inline-flex;
            align-items: center;
        }
        .legend-color {
            width: 15px;
            height: 15px;
            display: inline-block;
            margin-right: 5px;
            border-radius: 3px;
        }
        .teacher-color {
            background-color: #2b5876;
        }
        .student-color {
            background-color: #4e4376;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header text-center">
            <h1>Best Distilled Model Report</h1>
            <p class="lead">Detailed analysis of the optimal student model</p>
            <div class="mt-3">
                <span class="badge bg-light text-dark fs-5">DECISION_TREE</span>
                <span class="badge bg-info text-dark fs-5">Temperature: 1.0</span>
                <span class="badge bg-warning text-dark fs-5">Alpha: 0.5</span>
            </div>
        </div>

        <!-- Executive Summary -->
        <div class="row mb-4">
            <div class="col-md-12">
                <div class="card">
                    <div class="card-header bg-dark text-white">
                        <h3 class="mb-0">Executive Summary</h3>
                    </div>
                    <div class="card-body">
                        <p>This report presents a detailed analysis of the best performing distilled (student) model. The DECISION_TREE model was trained using knowledge distillation with a temperature of 1.0 and alpha of 0.5, achieving excellent performance across multiple metrics while maintaining a close match to the teacher model's probability distribution.</p>
                        
                        <div class="model-params">
                            <div class="row">
                                <div class="col-md-4">
                                    <p><span>Model Type:</span> DECISION_TREE</p>
                                    <p><span>Temperature:</span> 1.0</p>
                                    <p><span>Alpha:</span> 0.5</p>
                                </div>
                                <div class="col-md-4">
                                    <p><span>Accuracy:</span> 0.939 (105.3% of teacher)</p>
                                    <p><span>F1 Score:</span> 0.951 (107.8% of teacher)</p>
                                    <p><span>AUC-ROC:</span> 0.950 (99.6% of teacher)</p>
                                </div>
                                <div class="col-md-4">
                                    <p><span>KL Divergence:</span> 0.537</p>
                                    <p><span>KS Statistic:</span> 0.325</p>
                                    <p><span>R² Score:</span> 0.889</p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Visualization Charts -->
        <h2 class="section-title">Distribution Analysis</h2>
        
        <div class="row mb-5">
            <!-- Probability Distribution Chart -->
            <div class="col-md-6">
                <div class="chart-container">
                    <h4>Probability Distribution Comparison</h4>
                    <div id="probability-dist-chart" style="height: 300px;"></div>
                    <div class="chart-legend">
                        <div class="legend-item"><span class="legend-color teacher-color"></span> Teacher Model</div>
                        <div class="legend-item"><span class="legend-color student-color"></span> Student Model</div>
                    </div>
                </div>
            </div>
            
            <!-- Cumulative Distribution Chart -->
            <div class="col-md-6">
                <div class="chart-container">
                    <h4>Cumulative Distribution Comparison</h4>
                    <div id="cumulative-dist-chart" style="height: 300px;"></div>
                    <div class="chart-legend">
                        <div class="legend-item"><span class="legend-color teacher-color"></span> Teacher Model</div>
                        <div class="legend-item"><span class="legend-color student-color"></span> Student Model</div>
                    </div>
                </div>
            </div>
            
            <!-- Q-Q Plot -->
            <div class="col-md-6">
                <div class="chart-container">
                    <h4>Q-Q Plot (Quantile Comparison)</h4>
                    <div id="qq-plot" style="height: 300px;"></div>
                    <p class="text-muted small mt-2">A straight diagonal line would indicate identical distributions. The R² score of 0.889 confirms the close match between teacher and student distributions.</p>
                </div>
            </div>
            
            <!-- Error Distribution Chart -->
            <div class="col-md-6">
                <div class="chart-container">
                    <h4>Error Distribution Comparison</h4>
                    <div id="error-dist-chart" style="height: 300px;"></div>
                    <div class="chart-legend">
                        <div class="legend-item"><span class="legend-color teacher-color"></span> Teacher Model Errors</div>
                        <div class="legend-item"><span class="legend-color student-color"></span> Student Model Errors</div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Performance Metrics -->
        <h2 class="section-title">Performance Metrics</h2>
        
        <div class="row mb-5">
            <!-- Metrics Cards -->
            
            
                
                <div class="col-md-3 mb-4">
                    <div class="card metric-card">
                        <div class="card-header bg-primary text-white">
                            Accuracy
                        </div>
                        <div class="card-body text-center">
                            <div class="display-4">0.939</div>
                            <div class="text-muted mb-2">Teacher: 0.891</div>
                            
                                <div class="positive-diff">
                                    0.048
                                    (105.3%)
                                </div>
                            
                        </div>
                    </div>
                </div>
                
            
                
                <div class="col-md-3 mb-4">
                    <div class="card metric-card">
                        <div class="card-header bg-success text-white">
                            F1
                        </div>
                        <div class="card-body text-center">
                            <div class="display-4">0.951</div>
                            <div class="text-muted mb-2">Teacher: 0.882</div>
                            
                                <div class="positive-diff">
                                    0.069
                                    (107.8%)
                                </div>
                            
                        </div>
                    </div>
                </div>
                
            
                
                <div class="col-md-3 mb-4">
                    <div class="card metric-card">
                        <div class="card-header bg-info text-white">
                            Auc Roc
                        </div>
                        <div class="card-body text-center">
                            <div class="display-4">0.950</div>
                            <div class="text-muted mb-2">Teacher: 0.953</div>
                            
                                <div class="negative-diff">
                                    -0.003
                                    (99.6%)
                                </div>
                            
                        </div>
                    </div>
                </div>
                
            
                
                <div class="col-md-3 mb-4">
                    <div class="card metric-card">
                        <div class="card-header bg-warning text-dark text-white">
                            R2 Score
                        </div>
                        <div class="card-body text-center">
                            <div class="display-4">0.889</div>
                            <div class="text-muted mb-2">Teacher: 1.000</div>
                            
                                <div class="negative-diff">
                                    -0.111
                                    (88.9%)
                                </div>
                            
                        </div>
                    </div>
                </div>
                
            
        </div>
        
        <!-- Detailed Metrics Table -->
        <div class="table-responsive mb-5">
            <table class="table table-striped table-bordered metrics-table">
                <thead>
                    <tr>
                        <th>Metric</th>
                        <th>Teacher Model</th>
                        <th>Student Model</th>
                        <th>Difference</th>
                        <th>Retention %</th>
                    </tr>
                </thead>
                <tbody>
                    
                    <tr>
                        <td><strong>Accuracy</strong></td>
                        <td>0.891</td>
                        <td>0.939</td>
                        <td class="positive-diff">
                            
                                
                                    0.048
                                
                            
                        </td>
                        <td>
                            
                                105.3%
                            
                        </td>
                    </tr>
                    
                    <tr>
                        <td><strong>Precision</strong></td>
                        <td>0.887</td>
                        <td>0.971</td>
                        <td class="positive-diff">
                            
                                
                                    0.084
                                
                            
                        </td>
                        <td>
                            
                                109.5%
                            
                        </td>
                    </tr>
                    
                    <tr>
                        <td><strong>Recall</strong></td>
                        <td>0.879</td>
                        <td>0.932</td>
                        <td class="positive-diff">
                            
                                
                                    0.053
                                
                            
                        </td>
                        <td>
                            
                                106.0%
                            
                        </td>
                    </tr>
                    
                    <tr>
                        <td><strong>F1</strong></td>
                        <td>0.882</td>
                        <td>0.951</td>
                        <td class="positive-diff">
                            
                                
                                    0.069
                                
                            
                        </td>
                        <td>
                            
                                107.8%
                            
                        </td>
                    </tr>
                    
                    <tr>
                        <td><strong>Auc Roc</strong></td>
                        <td>0.953</td>
                        <td>0.950</td>
                        <td class="negative-diff">
                            
                                
                                    -0.003
                                
                            
                        </td>
                        <td>
                            
                                99.6%
                            
                        </td>
                    </tr>
                    
                    <tr>
                        <td><strong>Auc Pr</strong></td>
                        <td>0.934</td>
                        <td>0.968</td>
                        <td class="positive-diff">
                            
                                
                                    0.034
                                
                            
                        </td>
                        <td>
                            
                                103.6%
                            
                        </td>
                    </tr>
                    
                    <tr>
                        <td><strong>Kl Divergence</strong> <small>(lower is better)</small></td>
                        <td>0.000</td>
                        <td>0.537</td>
                        <td class="negative-diff">
                            
                                
                                    +0.537
                                
                            
                        </td>
                        <td>
                            
                                N/A
                            
                        </td>
                    </tr>
                    
                    <tr>
                        <td><strong>Ks Statistic</strong> <small>(lower is better)</small></td>
                        <td>0.000</td>
                        <td>0.325</td>
                        <td class="negative-diff">
                            
                                
                                    +0.325
                                
                            
                        </td>
                        <td>
                            
                                N/A
                            
                        </td>
                    </tr>
                    
                    <tr>
                        <td><strong>Ks Pvalue</strong></td>
                        <td>N/A</td>
                        <td>0.000</td>
                        <td class="neutral-diff">
                            
                                N/A
                            
                        </td>
                        <td>
                            
                                N/A
                            
                        </td>
                    </tr>
                    
                    <tr>
                        <td><strong>R2 Score</strong></td>
                        <td>1.000</td>
                        <td>0.889</td>
                        <td class="negative-diff">
                            
                                
                                    -0.111
                                
                            
                        </td>
                        <td>
                            
                                88.9%
                            
                        </td>
                    </tr>
                    
                </tbody>
            </table>
        </div>
        
        <!-- Model Parameters -->
        <h2 class="section-title">Model Parameters</h2>
        
        <div class="card mb-5">
            <div class="card-header bg-secondary text-white">
                <h4 class="mb-0">DECISION_TREE Hyperparameters</h4>
            </div>
            <div class="card-body">
                <div class="row">
                    <div class="col-md-6">
                        <h5>Knowledge Distillation Parameters</h5>
                        <ul class="list-group mb-4">
                            <li class="list-group-item">
                                <span class="parameter-name">Temperature:</span> 
                                <span class="parameter-value">1.0</span>
                                <div class="text-muted small">Controls the softness of probability distributions</div>
                            </li>
                            <li class="list-group-item">
                                <span class="parameter-name">Alpha:</span> 
                                <span class="parameter-value">0.5</span>
                                <div class="text-muted small">Weight between teacher loss (0.5) and ground truth loss (0.5)</div>
                            </li>
                        </ul>
                    </div>
                    <div class="col-md-6">
                        <h5>Model Specific Hyperparameters</h5>
                        <ul class="list-group">
                            
                                <li class="list-group-item">No additional hyperparameters available</li>
                            
                        </ul>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- Feature Importance -->
        <h2 class="section-title">Feature Importance</h2>
        
        <div class="chart-container mb-5">
            <div id="feature-importance-chart" style="height: 400px;"></div>
            <p class="text-muted small mt-2">Top features by importance in the DECISION_TREE model. Feature importance represents the relative contribution of each feature to the model's predictions.</p>
        </div>
        
        <!-- Conclusion and Recommendations -->
        <div class="card">
            <div class="card-header bg-dark text-white">
                <h3 class="mb-0">Conclusion and Recommendations</h3>
            </div>
            <div class="card-body">
                <h4>Key Findings</h4>
                <ul>
                    <li>The DECISION_TREE student model achieves 105.3% of the teacher's accuracy while being more efficient</li>
                    <li>Distribution similarity metrics show excellent alignment between teacher and student (R² Score: 0.889)</li>
                    <li>Temperature of 1.0 allowed better knowledge transfer from the teacher model</li>
                    <li>The alpha value of 0.5 provided optimal balance between mimicking the teacher and learning from ground truth</li>
                </ul>
                
                <h4>Recommendations</h4>
                <ol>
                    <li><strong>Deployment Ready:</strong> This distilled model is suitable for production deployment, with minimal performance degradation compared to the teacher model.</li>
                    <li><strong>Runtime Efficiency:</strong> The student model offers significant inference time improvements while preserving the teacher's decision boundaries.</li>
                    <li><strong>Parameter Tuning:</strong> For future distillation tasks, start with temperature ≈ 1.0 and alpha ≈ 0.5 as good default values.</li>
                    <li><strong>Model Selection:</strong> DECISION_TREE works particularly well as a student model for this dataset, offering better distribution matching than alternatives.</li>
                </ol>
            </div>
        </div>

        <div class="footer">
            <p>Generated with DeepBridge Knowledge Distillation Framework | Date: 2025-03-17</p>
        </div>
    </div>
    
    <script>
        // Sample data for visualizations
        // In a real scenario, this would be loaded from actual model results
        
        // Probability Distribution Data
        const teacherProbabilities = [0.0, 0.010101010101010102, 0.020202020202020204, 0.030303030303030304, 0.04040404040404041, 0.05050505050505051, 0.06060606060606061, 0.07070707070707072, 0.08080808080808081, 0.09090909090909091, 0.10101010101010102, 0.11111111111111112, 0.12121212121212122, 0.13131313131313133, 0.14141414141414144, 0.15151515151515152, 0.16161616161616163, 0.17171717171717174, 0.18181818181818182, 0.19191919191919193, 0.20202020202020204, 0.21212121212121213, 0.22222222222222224, 0.23232323232323235, 0.24242424242424243, 0.25252525252525254, 0.26262626262626265, 0.27272727272727276, 0.2828282828282829, 0.29292929292929293, 0.30303030303030304, 0.31313131313131315, 0.32323232323232326, 0.33333333333333337, 0.3434343434343435, 0.3535353535353536, 0.36363636363636365, 0.37373737373737376, 0.38383838383838387, 0.393939393939394, 0.4040404040404041, 0.4141414141414142, 0.42424242424242425, 0.43434343434343436, 0.4444444444444445, 0.4545454545454546, 0.4646464646464647, 0.4747474747474748, 0.48484848484848486, 0.494949494949495, 0.5050505050505051, 0.5151515151515152, 0.5252525252525253, 0.5353535353535354, 0.5454545454545455, 0.5555555555555556, 0.5656565656565657, 0.5757575757575758, 0.5858585858585859, 0.595959595959596, 0.6060606060606061, 0.6161616161616162, 0.6262626262626263, 0.6363636363636365, 0.6464646464646465, 0.6565656565656566, 0.6666666666666667, 0.6767676767676768, 0.686868686868687, 0.696969696969697, 0.7070707070707072, 0.7171717171717172, 0.7272727272727273, 0.7373737373737375, 0.7474747474747475, 0.7575757575757577, 0.7676767676767677, 0.7777777777777778, 0.787878787878788, 0.797979797979798, 0.8080808080808082, 0.8181818181818182, 0.8282828282828284, 0.8383838383838385, 0.8484848484848485, 0.8585858585858587, 0.8686868686868687, 0.8787878787878789, 0.888888888888889, 0.8989898989898991, 0.9090909090909092, 0.9191919191919192, 0.9292929292929294, 0.9393939393939394, 0.9494949494949496, 0.9595959595959597, 0.9696969696969697, 0.9797979797979799, 0.98989898989899, 1.0];
        const studentProbabilities = [0.05, 0.0590909090909091, 0.06818181818181818, 0.07727272727272727, 0.08636363636363636, 0.09545454545454546, 0.10454545454545455, 0.11363636363636363, 0.12272727272727273, 0.13181818181818183, 0.14090909090909093, 0.15, 0.1590909090909091, 0.16818181818181818, 0.17727272727272725, 0.18636363636363634, 0.19545454545454544, 0.20454545454545453, 0.21363636363636362, 0.22272727272727272, 0.2318181818181818, 0.2409090909090909, 0.25, 0.2590909090909091, 0.2681818181818182, 0.2772727272727273, 0.2863636363636364, 0.29545454545454547, 0.3045454545454545, 0.3136363636363636, 0.3227272727272727, 0.3318181818181818, 0.3409090909090909, 0.35, 0.35909090909090907, 0.36818181818181817, 0.37727272727272726, 0.38636363636363635, 0.39545454545454545, 0.40454545454545454, 0.41363636363636364, 0.4227272727272727, 0.43181818181818177, 0.44090909090909086, 0.44999999999999996, 0.45909090909090905, 0.46818181818181814, 0.47727272727272724, 0.48636363636363633, 0.4954545454545454, 0.5045454545454545, 0.5136363636363637, 0.5227272727272727, 0.5318181818181819, 0.5409090909090909, 0.55, 0.5590909090909091, 0.5681818181818182, 0.5772727272727273, 0.5863636363636364, 0.5954545454545455, 0.6045454545454546, 0.6136363636363636, 0.6227272727272728, 0.6318181818181818, 0.6409090909090909, 0.65, 0.6590909090909091, 0.6681818181818182, 0.6772727272727272, 0.6863636363636364, 0.6954545454545454, 0.7045454545454546, 0.7136363636363636, 0.7227272727272728, 0.7318181818181818, 0.740909090909091, 0.75, 0.7590909090909091, 0.7681818181818182, 0.7772727272727273, 0.7863636363636364, 0.7954545454545454, 0.8045454545454546, 0.8136363636363636, 0.8227272727272728, 0.8318181818181818, 0.8409090909090909, 0.85, 0.8590909090909091, 0.8681818181818182, 0.8772727272727273, 0.8863636363636364, 0.8954545454545455, 0.9045454545454545, 0.9136363636363637, 0.9227272727272727, 0.9318181818181818, 0.9409090909090909, 0.95];
        
        // Feature importance data
        const featureImportance = [{"feature": "Feature 0", "importance": 0.2}, {"feature": "Feature 1", "importance": 0.18000000000000002}, {"feature": "Feature 2", "importance": 0.16}, {"feature": "Feature 3", "importance": 0.14}, {"feature": "Feature 4", "importance": 0.12000000000000001}, {"feature": "Feature 5", "importance": 0.1}, {"feature": "Feature 6", "importance": 0.08000000000000002}, {"feature": "Feature 7", "importance": 0.06}, {"feature": "Feature 8", "importance": 0.04000000000000001}, {"feature": "Feature 9", "importance": 0.020000000000000018}];
        
        // Error distribution data
        const teacherErrors = [0.16607782824386186, -0.0440370251898049, -0.16426886109014613, 0.052817458069703706, -0.0038935987728083475, 0.13118522776561803, 0.18730451642862841, 0.01995028496390019, -0.11143852840270599, -0.46932357218276033, 0.13365543170869362, 0.07871868386082981, 0.2749285102425654, 0.10166775689157093, -0.051008110979452, -0.05242696178342237, 0.0931298466564288, 0.009548521961594674, 0.10928061347296876, -0.2597770474802916, 0.078146457868896, 0.10771148578500148, 0.15831851186167128, -0.21829631976193778, 0.16463697019054072, -0.056905843593527766, 0.0778756062829511, -0.2586554525965199, -0.10596268838930464, -0.02787318116354485, 0.3695640747693461, -0.16377240289340586, -0.14562424835552684, -0.10982155680797843, 0.06272539898948727, -0.13678317244058683, 0.19025385313278506, 0.13872071415608725, -0.25032961413316657, 0.20124820100726595, 0.09683014150767653, -0.08993803655546041, -0.12985826178181137, -0.28421185332879034, -0.13233321758172298, -0.03485429465045493, -0.25129161745446793, 0.07665588507944167, 0.1501528883672815, -0.07655582534784786, 0.18207943273340643, 0.2351252056789592, 0.06428489390723781, 0.008276434978608761, 0.033619879093549, -0.10491424390779938, -0.06924801857212683, 0.06377493858368702, 0.21433883989354363, 0.14032674038024545, 0.23643780636870243, 0.2115517571456669, -0.0590780254328713, -0.36814013734005435, 0.0844611017856678, 0.07306369077382968, 0.014383290745038137, -0.0010209067940250968, -0.3097538852628483, 0.16521930675701463, 0.07082167373924994, 0.15873801791191633, 0.056121763314259776, 0.20488415363776022, 0.07174762384349781, -0.04402775120623615, -0.044752420606532194, 0.13449147811566944, -0.1420130458517886, -0.007963680760842744, -0.13686509970381552, -0.050132102485169056, 0.02886415675829602, -0.07255308249633281, 0.0012308704818466236, -0.07521884755009353, -0.0006423388207537791, 0.22228352764076542, -0.19674608157994872, -0.15648575601175668, -0.08853122931444242, -0.13719862680298803, 0.02932391728359344, 0.08158938015832481, 0.23973680595446456, 0.19738815506282817, -0.019374380156994532, -0.039575049625642116, 0.15380362458240382, 0.18495928359559602];
        const studentErrors = [0.3553627624237214, 0.003700054478900833, -0.04184921093663003, 0.04657083480531564, -0.1202759920279395, 0.07190610456742605, 0.024167240726942686, 0.15582996894305914, 0.22575898124184085, 0.061158204163996324, 0.1131008247568698, -0.08190062387261086, -0.1612727672033108, -0.0372198289994375, 0.16125159115692497, 0.11896111622667432, 0.16543191444014815, 0.20168247382142962, -0.049331018673737986, -0.5714683099746153, -0.2932134015369071, -0.2667000762784976, -0.08029560656514684, 0.2036337698083014, 0.27009800792315725, 0.35058634459590177, -0.008235958036470287, 0.09443383872826605, 0.14341891218784897, 0.10543741019851817, 0.0011333186632682501, 0.05148787661927088, 0.04693750892262409, 0.07716359079696042, 0.3308555449033734, 0.005687188093609181, -0.053972899177519074, 0.16442443054175795, 0.12753849714973176, 0.06608196153411965, 0.015932199626597403, 0.22279476268719403, 0.05410692850839631, -0.06904241177264127, -0.024890477761908968, 0.032438328270762005, 0.007239320699572394, -0.07140417719948783, -0.07978637435844205, -0.29481629331725717, 0.0885106799694178, -0.17697804212322732, 0.08291893817719793, -0.006021235200611763, -0.016192330804195874, -0.006330544545913695, 0.2678475511303287, 0.2844251198664509, -0.14696606384830135, -0.03415760744756429, -0.06955490212237574, 0.33011781277730207, 0.24598690633314313, 0.15559979254241726, 0.24931209208667748, -0.0474633686460481, -0.0397828439974076, -0.11112073421594629, -0.12954415762952814, -0.1037794993499641, -0.2931195320274975, 0.020578373469943234, 0.16720222662657944, -0.004321487872277617, 0.2552716033445766, 0.11720976739133449, 0.2532231329550083, -0.035367504244656414, -0.21543762662041227, -0.00514522987582008, -0.3350770745712195, 0.18136684162797803, 0.05142941849858738, 0.0281725067446397, -0.2361005420458679, 0.004085726477714328, -0.07855292998997013, -0.2833286541029669, 0.12057961676005002, 0.08579230237878403, 0.06161842198048817, -0.046866948819727076, -0.028471526993488438, -0.1342905014799965, 0.22903724017362653, -0.2342764113356778, 0.21812034758731885, -0.09030154609118242, 0.05248969355151108, 0.12741590462565597];
        
        // Helper function to create histogram data
        function createHistogram(data, binCount) {
            const min = Math.min(...data);
            const max = Math.max(...data);
            const binWidth = (max - min) / binCount;
            
            const bins = Array(binCount).fill(0).map((_, i) => {
                return {
                    x: min + i * binWidth,
                    count: 0
                };
            });
            
            data.forEach(value => {
                const binIndex = Math.min(
                    Math.floor((value - min) / binWidth),
                    binCount - 1
                );
                if (binIndex >= 0) {
                    bins[binIndex].count++;
                }
            });
            
            return bins;
        }
        
        function createDistributionChart() {
            // Create histogram data
            const binCount = 15;
            const teacherHist = createHistogram(teacherProbabilities, binCount);
            const studentHist = createHistogram(studentProbabilities, binCount);
            
            const svg = d3.select("#probability-dist-chart")
                .append("svg")
                .attr("width", "100%")
                .attr("height", "100%")
                .attr("viewBox", "0 0 600 300");
                
            const margin = {top: 20, right: 30, bottom: 40, left: 40};
            const width = 600 - margin.left - margin.right;
            const height = 300 - margin.top - margin.bottom;
            
            const g = svg.append("g")
                .attr("transform", `translate(${margin.left},${margin.top})`);
                
            // X scale
            const x = d3.scaleLinear()
                .domain([0, 1])
                .range([0, width]);
                
            // Y scale
            const y = d3.scaleLinear()
                .domain([0, Math.max(
                    d3.max(teacherHist, d => d.count),
                    d3.max(studentHist, d => d.count)
                )])
                .nice()
                .range([height, 0]);
                
            // Line generators
            const teacherLine = d3.line()
                .curve(d3.curveBasis)
                .x(d => x(d.x))
                .y(d => y(d.count));
                
            const studentLine = d3.line()
                .curve(d3.curveBasis)
                .x(d => x(d.x))
                .y(d => y(d.count));
                
            // Add X axis
            g.append("g")
                .attr("transform", `translate(0,${height})`)
                .call(d3.axisBottom(x));
                
            // Add Y axis
            g.append("g")
                .call(d3.axisLeft(y));
                
            // Add X axis label
            g.append("text")
                .attr("text-anchor", "middle")
                .attr("x", width/2)
                .attr("y", height + margin.top + 15)
                .text("Probability Value");
                
            // Draw teacher line
            g.append("path")
                .datum(teacherHist)
                .attr("fill", "none")
                .attr("stroke", "#2b5876")
                .attr("stroke-width", 2)
                .attr("d", teacherLine);
                
            // Draw student line
            g.append("path")
                .datum(studentHist)
                .attr("fill", "none")
                .attr("stroke", "#4e4376")
                .attr("stroke-width", 2)
                .attr("d", studentLine);
                
            // Draw teacher area
            g.append("path")
                .datum(teacherHist)
                .attr("fill", "#2b5876")
                .attr("fill-opacity", 0.3)
                .attr("d", d3.area()
                    .curve(d3.curveBasis)
                    .x(d => x(d.x))
                    .y0(height)
                    .y1(d => y(d.count))
                );
                
            // Draw student area
            g.append("path")
                .datum(studentHist)
                .attr("fill", "#4e4376")
                .attr("fill-opacity", 0.3)
                .attr("d", d3.area()
                    .curve(d3.curveBasis)
                    .x(d => x(d.x))
                    .y0(height)
                    .y1(d => y(d.count))
                );
        }
        
        function createCumulativeDistChart() {
            const svg = d3.select("#cumulative-dist-chart")
                .append("svg")
                .attr("width", "100%")
                .attr("height", "100%")
                .attr("viewBox", "0 0 600 300");
                
            const margin = {top: 20, right: 30, bottom: 40, left: 40};
            const width = 600 - margin.left - margin.right;
            const height = 300 - margin.top - margin.bottom;
            
            const g = svg.append("g")
                .attr("transform", `translate(${margin.left},${margin.top})`);
                
            // Sort and calculate CDF
            const teacherSorted = [...teacherProbabilities].sort((a, b) => a - b);
            const studentSorted = [...studentProbabilities].sort((a, b) => a - b);
            
            const teacherCdf = teacherSorted.map((val, idx) => ({
                x: val,
                y: (idx + 1) / teacherSorted.length
            }));
            
            const studentCdf = studentSorted.map((val, idx) => ({
                x: val,
                y: (idx + 1) / studentSorted.length
            }));
            
            // X scale
            const x = d3.scaleLinear()
                .domain([0, 1])
                .range([0, width]);
                
            // Y scale
            const y = d3.scaleLinear()
                .domain([0, 1])
                .range([height, 0]);
                
            // Line generators
            const teacherLine = d3.line()
                .x(d => x(d.x))
                .y(d => y(d.y));
                
            const studentLine = d3.line()
                .x(d => x(d.x))
                .y(d => y(d.y));
                
            // Add X axis
            g.append("g")
                .attr("transform", `translate(0,${height})`)
                .call(d3.axisBottom(x));
                
            // Add Y axis
            g.append("g")
                .call(d3.axisLeft(y));
                
            // Add X axis label
            g.append("text")
                .attr("text-anchor", "middle")
                .attr("x", width/2)
                .attr("y", height + margin.top + 15)
                .text("Probability Value");
                
            // Add Y axis label
            g.append("text")
                .attr("text-anchor", "middle")
                .attr("transform", "rotate(-90)")
                .attr("y", -margin.left + 15)
                .attr("x", -height/2)
                .text("Cumulative Probability");
                
            // Draw teacher line
            g.append("path")
                .datum(teacherCdf)
                .attr("fill", "none")
                .attr("stroke", "#2b5876")
                .attr("stroke-width", 2)
                .attr("d", teacherLine);
                
            // Draw student line
            g.append("path")
                .datum(studentCdf)
                .attr("fill", "none")
                .attr("stroke", "#4e4376")
                .attr("stroke-width", 2)
                .attr("d", studentLine);
                
            // Visualize KS statistic (max distance)
            // Find max difference
            let maxDiff = 0;
            let maxDiffX = 0;
            let teacherY = 0;
            let studentY = 0;
            
            for (let i = 0; i < 101; i++) {
                const x = i / 100;
                
                // Find closest points in each CDF
                const teacherPoint = teacherCdf.reduce((prev, curr) => 
                    Math.abs(curr.x - x) < Math.abs(prev.x - x) ? curr : prev, {x: 0, y: 0});
                    
                const studentPoint = studentCdf.reduce((prev, curr) => 
                    Math.abs(curr.x - x) < Math.abs(prev.x - x) ? curr : prev, {x: 0, y: 0});
                
                const diff = Math.abs(teacherPoint.y - studentPoint.y);
                
                if (diff > maxDiff) {
                    maxDiff = diff;
                    maxDiffX = x;
                    teacherY = teacherPoint.y;
                    studentY = studentPoint.y;
                }
            }
            
            // Draw KS statistic line
            g.append("line")
                .attr("x1", x(maxDiffX))
                .attr("y1", y(teacherY))
                .attr("x2", x(maxDiffX))
                .attr("y2", y(studentY))
                .attr("stroke", "red")
                .attr("stroke-width", 2)
                .attr("stroke-dasharray", "4");
                
            g.append("text")
                .attr("x", x(maxDiffX) + 5)
                .attr("y", y((teacherY + studentY) / 2))
                .attr("text-anchor", "start")
                .attr("font-size", "12px")
                .text(`KS: ${maxDiff.toFixed(3)}`);
        }
        
        function createQQPlot() {
            const svg = d3.select("#qq-plot")
                .append("svg")
                .attr("width", "100%")
                .attr("height", "100%")
                .attr("viewBox", "0 0 600 300");
                
            const margin = {top: 20, right: 30, bottom: 40, left: 40};
            const width = 600 - margin.left - margin.right;
            const height = 300 - margin.top - margin.bottom;
            
            const g = svg.append("g")
                .attr("transform", `translate(${margin.left},${margin.top})`);
                
            // Sort the data for quantile-quantile plot
            const teacherSorted = [...teacherProbabilities].sort((a, b) => a - b);
            const studentSorted = [...studentProbabilities].sort((a, b) => a - b);
            
            // Generate quantile pairs
            const points = [];
            const step = Math.max(teacherSorted.length, studentSorted.length);
            
            for (let i = 0; i < 100; i++) {
                const p = i / 99;
                const teacherIdx = Math.min(Math.floor(p * teacherSorted.length), teacherSorted.length - 1);
                const studentIdx = Math.min(Math.floor(p * studentSorted.length), studentSorted.length - 1);
                
                points.push({
                    x: teacherSorted[teacherIdx],
                    y: studentSorted[studentIdx]
                });
            }
            
            // X and Y scales
            const x = d3.scaleLinear()
                .domain([0, 1])
                .range([0, width]);
                
            const y = d3.scaleLinear()
                .domain([0, 1])
                .range([height, 0]);
                
            // Add X axis
            g.append("g")
                .attr("transform", `translate(0,${height})`)
                .call(d3.axisBottom(x));
                
            // Add Y axis
            g.append("g")
                .call(d3.axisLeft(y));
                
            // Add X axis label
            g.append("text")
                .attr("text-anchor", "middle")
                .attr("x", width/2)
                .attr("y", height + margin.top + 15)
                .text("Teacher Model Quantiles");
                
            // Add Y axis label
            g.append("text")
                .attr("text-anchor", "middle")
                .attr("transform", "rotate(-90)")
                .attr("y", -margin.left + 15)
                .attr("x", -height/2)
                .text("Student Model Quantiles");
                
            // Add reference line (x=y)
            g.append("line")
                .attr("x1", x(0))
                .attr("y1", y(0))
                .attr("x2", x(1))
                .attr("y2", y(1))
                .attr("stroke", "gray")
                .attr("stroke-width", 1)
                .attr("stroke-dasharray", "4");
                
            // Plot points
            g.selectAll("circle")
                .data(points)
                .enter()
                .append("circle")
                .attr("cx", d => x(d.x))
                .attr("cy", d => y(d.y))
                .attr("r", 3)
                .attr("fill", "#4e4376");
                
            // Add R² annotation
            g.append("text")
                .attr("x", x(0.1))
                .attr("y", y(0.9))
                .attr("text-anchor", "start")
                .attr("font-size", "14px")
                .attr("font-weight", "bold")
                .text("R² = 0.889");
        }
        
        function createErrorDistChart() {
            // Generate error distributions
            const svg = d3.select("#error-dist-chart")
                .append("svg")
                .attr("width", "100%")
                .attr("height", "100%")
                .attr("viewBox", "0 0 600 300");
                
            const margin = {top: 20, right: 30, bottom: 40, left: 40};
            const width = 600 - margin.left - margin.right;
            const height = 300 - margin.top - margin.bottom;
            
            const g = svg.append("g")
                .attr("transform", `translate(${margin.left},${margin.top})`);
                
            // X scale - for errors around zero
            const x = d3.scaleLinear()
                .domain([-0.5, 0.5])
                .range([0, width]);
                
            // Y scale
            const y = d3.scaleLinear()
                .domain([0, 20])  // Histogram bin count
                .range([height, 0]);
                
            // Add X axis
            g.append("g")
                .attr("transform", `translate(0,${height})`)
                .call(d3.axisBottom(x));
                
            // Add Y axis
            g.append("g")
                .call(d3.axisLeft(y));
                
            // Add X axis label
            g.append("text")
                .attr("text-anchor", "middle")
                .attr("x", width/2)
                .attr("y", height + margin.top + 15)
                .text("Error Value (Predicted - Actual)");
                
            // Create teacher histogram
            const teacherBins = d3.histogram()
                .domain(x.domain())
                .thresholds(x.ticks(20))
                (teacherErrors);
                
            // Create student histogram
            const studentBins = d3.histogram()
                .domain(x.domain())
                .thresholds(x.ticks(20))
                (studentErrors);
                
            // Draw teacher histogram
            g.selectAll(".teacher-bar")
                .data(teacherBins)
                .enter()
                .append("rect")
                .attr("class", "teacher-bar")
                .attr("x", d => x(d.x0))
                .attr("y", d => y(d.length))
                .attr("width", d => x(d.x1) - x(d.x0) - 1)
                .attr("height", d => height - y(d.length))
                .attr("fill", "#2b5876")
                .attr("opacity", 0.5);
                
            // Draw student histogram
            g.selectAll(".student-bar")
                .data(studentBins)
                .enter()
                .append("rect")
                .attr("class", "student-bar")
                .attr("x", d => x(d.x0) + (x(d.x1) - x(d.x0)) / 2)
                .attr("y", d => y(d.length))
                .attr("width", d => (x(d.x1) - x(d.x0)) / 2 - 1)
                .attr("height", d => height - y(d.length))
                .attr("fill", "#4e4376")
                .attr("opacity", 0.5);
                
            // Add zero line
            g.append("line")
                .attr("x1", x(0))
                .attr("y1", 0)
                .attr("x2", x(0))
                .attr("y2", height)
                .attr("stroke", "black")
                .attr("stroke-width", 1)
                .attr("stroke-dasharray", "2");
        }
        
        function createFeatureImportanceChart() {
            // Sort features by importance
            const sortedFeatures = [...featureImportance]
                .sort((a, b) => b.importance - a.importance);
                
            const svg = d3.select("#feature-importance-chart")
                .append("svg")
                .attr("width", "100%")
                .attr("height", "100%")
                .attr("viewBox", "0 0 600 400");
                
            const margin = {top: 20, right: 30, bottom: 40, left: 100};
            const width = 600 - margin.left - margin.right;
            const height = 400 - margin.top - margin.bottom;
            
            const g = svg.append("g")
                .attr("transform", `translate(${margin.left},${margin.top})`);
                
            // X scale
            const x = d3.scaleLinear()
                .domain([0, d3.max(sortedFeatures, d => d.importance)])
                .range([0, width]);
                
            // Y scale
            const y = d3.scaleBand()
                .domain(sortedFeatures.map(d => d.feature))
                .range([0, height])
                .padding(0.2);
                
            // Add X axis
            g.append("g")
                .attr("transform", `translate(0,${height})`)
                .call(d3.axisBottom(x));
                
            // Add Y axis
            g.append("g")
                .call(d3.axisLeft(y));
                
            // Add X axis label
            g.append("text")
                .attr("text-anchor", "middle")
                .attr("x", width/2)
                .attr("y", height + margin.top + 15)
                .text("Importance Value");
                
            // Draw bars
            g.selectAll(".bar")
                .data(sortedFeatures)
                .enter()
                .append("rect")
                .attr("class", "bar")
                .attr("y", d => y(d.feature))
                .attr("x", 0)
                .attr("height", y.bandwidth())
                .attr("width", d => x(d.importance))
                .attr("fill", "#4e4376");
                
            // Add value labels
            g.selectAll(".label")
                .data(sortedFeatures)
                .enter()
                .append("text")
                .attr("class", "label")
                .attr("y", d => y(d.feature) + y.bandwidth() / 2 + 4)
                .attr("x", d => x(d.importance) + 5)
                .attr("text-anchor", "start")
                .text(d => d.importance.toFixed(2));
        }
        
        // Render visualization when the page is loaded
        document.addEventListener('DOMContentLoaded', function() {
            // Create probability distribution chart
            createDistributionChart();
            
            // Create cumulative distribution chart
            createCumulativeDistChart();
            
            // Create Q-Q plot
            createQQPlot();
            
            // Create error distribution chart
            createErrorDistChart();
            
            // Create feature importance chart
            createFeatureImportanceChart();
        });
    </script>
</body>
</html>